<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Co-pilota AI per lo sviluppo commerciale – Accesso Anticipato | Q1 2026</title>

    <!-- Open Graph / LinkedIn -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Co-pilota AI per lo sviluppo commerciale – Accesso Anticipato | Q1 2026">
    <meta property="og:description" content="Il Co-Pilot AI dedicato ai consulenti finanziari: lead qualificati, esclusività territoriale e automazione end-to-end. Unisciti alla waiting list.">
    <meta property="og:image" content="https://example.com/og-image.jpg">
    <meta property="og:url" content="https://example.com/waitlist">
    <meta property="og:locale" content="it_IT">

    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Co-pilota AI per lo sviluppo commerciale – Accesso Anticipato | Q1 2026">
    <meta name="twitter:description" content="Il Co-Pilot AI per consulenti finanziari: lead qualificati, esclusività per area e outreach automatizzato.">
    <meta name="twitter:image" content="https://example.com/og-image.jpg">

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400;1,600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-grad-start: #0a0a0a;
            --bg-grad-mid: #1a1a2e;
            --bg-grad-end: #16213e;
            --color-success: #4CAF50;
            --color-primary: #2196F3;
            --color-warning: #FF9800;
            --color-danger: #FF4444;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --text-muted: #999999;
            --surface-03: rgba(255,255,255,0.03);
            --surface-05: rgba(255,255,255,0.05);
            --border-08: rgba(255,255,255,0.08);
            --border-12: rgba(255,255,255,0.12);
            --blur: 15px;
            --radius-card: 20px;
            --radius-btn: 14px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            background: linear-gradient(135deg, var(--bg-grad-start) 0%, var(--bg-grad-mid) 50%, var(--bg-grad-end) 100%);
            min-height: 100vh;
            color: var(--text-primary);
            font-weight: 400;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Navigation Minimal */
        .navbar { position: fixed; top: 0; left: 0; right: 0; z-index: 1000; padding: 20px 40px; background: var(--surface-03); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border-bottom: 1px solid var(--border-08); }
        .nav-container { max-width: 1400px; margin: 0 auto; text-align: center; }
        .logo { font-size: 24px; font-weight: 300; color: var(--text-primary); text-decoration: none; letter-spacing: -0.02em; }
        .logo .premium { font-family: 'Playfair Display', serif; font-style: italic; font-weight: 400; }

        /* Hero Section */
        .hero { min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 80px 40px 40px; position: relative; }
        .hero-content { max-width: 900px; width: 100%; text-align: center; }

        .launch-badge { display: inline-block; background: linear-gradient(135deg, var(--color-warning), var(--color-danger)); color: white; padding: 8px 24px; border-radius: 30px; font-size: 14px; font-weight: 600; margin-bottom: 40px; animation: pulse 3s infinite; text-transform: uppercase; letter-spacing: 1px; }
        @keyframes pulse { 0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 152, 0, 0.4);} 70% { transform: scale(1.02); box-shadow: 0 0 0 10px rgba(255, 152, 0, 0);} 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 152, 0, 0);} }

        .hero-title { font-size: 72px; font-weight: 300; letter-spacing: -0.03em; margin-bottom: 30px; line-height: 1.1; }
        .hero-title .gradient { background: linear-gradient(135deg, var(--color-primary), var(--color-success)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 400; }
        .hero-title .premium { font-family: 'Playfair Display', serif; font-style: italic; font-weight: 400; }

        .hero-subtitle { font-size: 24px; color: var(--text-secondary); font-weight: 300; margin-bottom: 50px; max-width: 700px; margin-left: auto; margin-right: auto; line-height: 1.5; }

        /* Urgency Indicator */
        .urgency-bar { background: var(--surface-05); border: 1px solid var(--border-08); border-radius: 30px; padding: 15px 30px; margin-bottom: 50px; backdrop-filter: blur(10px); display: inline-block; }
        .urgency-text { color: var(--color-warning); font-weight: 500; font-size: 14px; }
        .spots-left { color: var(--text-primary); font-weight: 700; font-size: 16px;  }

        /* Waiting List Form */
        .waitlist-form-container { background: var(--surface-03); border: 1px solid var(--border-08); border-radius: var(--radius-card); padding: 50px; backdrop-filter: blur(var(--blur)); -webkit-backdrop-filter: blur(var(--blur)); max-width: 600px; margin: 0 auto 60px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
        .form-title { font-size: 28px; font-weight: 400; margin-bottom: 15px; text-align: center; line-height: 1.4; }
        .form-subtitle { font-size: 16px; color: var(--text-secondary); margin-bottom: 40px; text-align: center; }
        .form-group { margin-bottom: 25px; text-align: left; }
        .form-label { display: block; font-size: 14px; color: var(--text-secondary); margin-bottom: 10px; font-weight: 500; }
        .form-input { width: 100%; padding: 15px 20px; background: #2a2a2a; border: 1px solid #444; color: white; border-radius: 12px; font-size: 16px; transition: all 0.3s ease; }
        .form-input:focus { outline: none; border-color: var(--color-success); box-shadow: 0 0 0 3px rgba(76,175,80,0.25); }
        .form-select { width: 100%; padding: 15px 20px; background: #2a2a2a; border: 1px solid #444; color: white; border-radius: 12px; font-size: 16px; cursor: pointer; transition: all 0.3s ease; }
        .form-checkbox-group { display: flex; align-items: flex-start; gap: 12px; margin-bottom: 30px; }
        .form-checkbox { margin-top: 5px; }
        .form-checkbox-label { font-size: 14px; color: var(--text-secondary); line-height: 1.5; }
        .btn-submit { width: 100%; padding: 18px 40px; background: linear-gradient(180deg, rgba(76,175,80,0.35), rgba(76,175,80,0.10)); border: 1px solid rgba(76,175,80,0.55); color: white; border-radius: var(--radius-btn); font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 1px; }
        .btn-submit:hover { transform: translateY(-3px); box-shadow: 0 15px 40px rgba(76,175,80,0.35); }
        .btn-submit:disabled { opacity: 0.5; cursor: not-allowed; }

        /* Success Message */
        .success-message { display: none; background: linear-gradient(135deg, rgba(76,175,80,0.2), rgba(76,175,80,0.1)); border: 1px solid var(--color-success); border-radius: var(--radius-card); padding: 30px; text-align: center; margin-bottom: 30px; }
        .success-message.show { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px);} to { opacity: 1; transform: translateY(0);} }

        /* Teaser Section */
        .teaser-section { padding: 80px 40px; max-width: 1200px; margin: 0 auto; }
        .section-title { font-size: 42px; font-weight: 300; text-align: center; margin-bottom: 60px; letter-spacing: -0.02em; }
        .teaser-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 40px; }
        .teaser-card { text-align: center; opacity: 0; transform: translateY(20px); animation: fadeInUp 0.8s ease forwards; }
        .teaser-card:nth-child(1) { animation-delay: 0.1s; } .teaser-card:nth-child(2) { animation-delay: 0.2s; } .teaser-card:nth-child(3) { animation-delay: 0.3s; } .teaser-card:nth-child(4) { animation-delay: 0.4s; } .teaser-card:nth-child(5) { animation-delay: 0.5s; } .teaser-card:nth-child(6) { animation-delay: 0.6s; }
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0);} }
        .teaser-icon { font-size: 48px; margin-bottom: 20px; filter: blur(0px); transition: all 0.3s ease; }
        .teaser-title { font-size: 20px; font-weight: 500; margin-bottom: 15px; color: var(--text-primary); }
        .teaser-description { font-size: 14px; color: var(--text-secondary); line-height: 1.8; }
        .teaser-soon { display: inline-block; background: var(--surface-05); border: 1px solid var(--border-08); padding: 4px 12px; border-radius: 20px; font-size: 11px; color: var(--color-primary); margin-top: 10px; text-transform: uppercase; }

        /* FAQ Minimal */
        .faq { padding: 80px 40px; max-width: 800px; margin: 0 auto; }
        .faq-item { background: var(--surface-03); border: 1px solid var(--border-08); border-radius: var(--radius-card); padding: 30px; backdrop-filter: blur(var(--blur)); margin-bottom: 20px; cursor: pointer; transition: all 0.3s ease; }
        .faq-item:hover { border-color: var(--border-12); }
        .faq-question { font-size: 18px; font-weight: 500; color: var(--text-primary); display: flex; justify-content: space-between; align-items: center; }
        .faq-icon { font-size: 24px; transition: transform 0.3s ease; }
        .faq-item.active .faq-icon { transform: rotate(45deg); }
        .faq-answer { display: none; margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border-08); color: var(--text-secondary); line-height: 1.8; }
        .faq-item.active .faq-answer { display: block; }

        /* Footer */
        .footer { padding: 60px 40px; text-align: center; }
        .footer-content { max-width: 800px; margin: 0 auto; }
        .social-links { display: flex; justify-content: center; gap: 30px; margin-bottom: 30px; }
        .social-link { color: var(--text-secondary); text-decoration: none; font-size: 14px; transition: color 0.3s ease; }
        .social-link:hover { color: var(--text-primary); }
        .footer-text { color: var(--text-muted); font-size: 14px; }

        /* Progress Bar (minimal) */
        .progress-container { margin-bottom: 12px; max-width: 500px; margin-left: auto; margin-right: auto; }
        .progress-label { display: flex; justify-content: center; gap: 8px; margin-bottom: 10px; font-size: 14px; color: var(--text-secondary); }
        .progress-bar { height: 8px; background: var(--surface-05); border-radius: 10px; overflow: hidden; position: relative; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--color-primary), var(--color-success)); width: 0%; border-radius: 10px; transition: width 0.3s ease; position: relative; animation: shimmer 2s infinite; }
        @keyframes shimmer { 0% { opacity: 0.8;} 50% { opacity: 1;} 100% { opacity: 0.8;} }
        .oversub-note { display: none; text-align: center; font-size: 12px; color: var(--text-muted); margin-top: 8px; }
        .oversub-note.show { display: block; }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-title { font-size: 42px; }
            .hero-subtitle { font-size: 18px; }
            .waitlist-form-container { padding: 30px 20px; }
            .teaser-grid { grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 24px; }
            .trust-badges { flex-direction: column; gap: 20px; }
        }

        /* Loading spinner */
        .spinner { display: none; width: 20px; height: 20px; border: 3px solid rgba(255,255,255,0.2); border-top-color: white; border-radius: 50%; animation: spin 0.8s linear infinite; margin: 0 auto; }
        .spinner.show { display: block; }
        @keyframes spin { to { transform: rotate(360deg);} }

        /* Counter animation */
        .counter { display: inline-block; animation: countUp 0.5s ease-out; }
        @keyframes countUp { from { transform: scale(0.8); opacity: 0;} to { transform: scale(1); opacity: 1;} }
    </style>
</head>
<body>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <div class="launch-badge">🎯 ACCESSO ESCLUSIVO DAL 2 FEBBRAIO</div>
            
            <h1 class="hero-title">Trovare <span class="premium">nuovi clienti</span> non è mai stato così facile</h1>
            
            <p class="hero-subtitle">Il primo co-pilota per lo sviluppo commerciale dedicato ai consulenti finanziari</p>

            <!-- Urgency Bar (rimane, ma coerente con 100 posti) -->
            <div class="urgency-bar">
                <span class="urgency-text">⚡ </span>
                <span class="spots-left" id="spotsLeft">100</span>
                <span class="urgency-text"> posti rimanenti su 100</span>
            </div>

            <!-- Progress Bar Minimal -->
            <div class="progress-container">
                <div class="progress-label" id="progressLabel">Posti disponibili: 100 • Iscrizioni: <span id="subsCount" class="counter">0</span></div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div id="oversubNote" class="oversub-note">Sovrascritta – i posti verranno assegnati in ordine di iscrizione e priorità di provincia.</div>
            </div>

            <!-- Waiting List Form -->
            <div class="waitlist-form-container">
                <h2 class="form-title">Accedi prima degli altri<br>Iscriviti Ora!</h2>
                <p class="form-subtitle">Ricevi l'accesso prioritario prima del lancio ufficiale</p>

                <!-- Success Message -->
                <div class="success-message" id="successMessage">
                    <div style="font-size: 48px; margin-bottom: 20px;">🎉</div>
                    <h3 style="font-size: 24px; margin-bottom: 10px;">Sei nella lista!</h3>
                    <p style="color: var(--text-secondary);">Ti contatteremo appena saremo pronti per il lancio. Controlla la tua email per la conferma.</p>
                </div>

                <form id="waitlistForm">
                    <div class="form-group">
                        <label class="form-label" for="name">Nome e Cognome *</label>
                        <input type="text" id="name" name="name" class="form-input" required placeholder="Mario Rossi">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="email">Email Professionale *</label>
                        <input type="email" id="email" name="email" class="form-input" required placeholder="mario@azienda.com">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="company">Azienda *</label>
                        <input type="text" id="company" name="company" class="form-input" placeholder="Nome Azienda" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="role">Ruolo *</label>
                        <select id="role" name="role" class="form-select" required>
                            <option value="">Seleziona il tuo ruolo</option>
                            <option value="consulente">Consulente Finanziario</option>
                            <option value="private">Private Banker</option>
                            <option value="business">Business Manager</option>
                            <option value="group">Group Manager</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="province">Provincia di tuo interesse *</label>
                        <select id="province" name="province" class="form-select" required>
                            <option value="">Seleziona una provincia</option>
                            <option value="bergamo">Bergamo</option>
                            <option value="brescia">Brescia</option>
                            <option value="como">Como</option>
                            <option value="cremona">Cremona</option>
                            <option value="lecco">Lecco</option>
                            <option value="lodi">Lodi</option>
                            <option value="mantova">Mantova</option>
                            <option value="milano">Milano</option>
                            <option value="monza">Monza e Brianza</option>
                            <option value="pavia">Pavia</option>
                            <option value="sondrio">Sondrio</option>
                            <option value="varese">Varese</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="leads">Attualmente, quanti nuovi clienti contatti a settimana? *</label>
                        <select id="leads" name="leads" class="form-select" required>
                            <option value="">Seleziona una fascia</option>
                            <option value="0-2">0–2</option>
                            <option value="3-5">3–5</option>
                            <option value="6+">6+</option>
                        </select>
                    </div>

                    <div class="form-checkbox-group">
                        <input type="checkbox" id="privacy" name="privacy" class="form-checkbox" required>
                        <label for="privacy" class="form-checkbox-label">Accetto la Privacy Policy e acconsento a ricevere comunicazioni relative al lancio del prodotto *</label>
                    </div>

                    <button type="submit" class="btn-submit" id="submitBtn">Blocca il tuo Accesso Prioritario</button>
                    <div class="spinner" id="spinner"></div>
                </form>

                <p style="text-align: center; margin-top: 20px; color: var(--text-muted); font-size: 12px;">🔒 I tuoi dati sono al sicuro. Zero spam, solo aggiornamenti importanti.</p>
            </div>
        </div>
    </section>

    <!-- Teaser Section -->
    <section class="teaser-section">
        <h2 class="section-title">Tutto quello che ti serve per fare <span class="premium">sviluppo</span></h2>
        
        <div class="teaser-grid">
            <div class="teaser-card">
                <div class="teaser-icon">🎯</div>
                <h3 class="teaser-title">Contatti Pre-Qualificati</h3>
                <p class="teaser-description">Accedi ogni settimana a contatti già verificati e in target con la tua area d'interesse.</p>
                <span class="teaser-soon">Dettagli al lancio</span>
            </div>
            
            <div class="teaser-card">
                <div class="teaser-icon">✉️</div>
                <h3 class="teaser-title">Email Verificate</h3>
                <p class="teaser-description">Ti forniamo email professionali validate e pronte per l'attività di sviluppo.</p>
                <span class="teaser-soon">Dettagli al lancio</span>
            </div>
            
            <div class="teaser-card">
                <div class="teaser-icon">🤖</div>
                <h3 class="teaser-title">AI Co-Pilot</h3>
                <p class="teaser-description">Messaggi personalizzati e pronti all'invio, generati su misura per ciascun contatto.</p>
                <span class="teaser-soon">Dettagli al lancio</span>
            </div>

            <div class="teaser-card">
                <div class="teaser-icon">🔒</div>
                <h3 class="teaser-title">Esclusività Territoriale</h3>
                <p class="teaser-description">Ogni area ha posti limitati: i tuoi contatti non saranno mai condivisi con altri consulenti.</p>
                <span class="teaser-soon">Dettagli al lancio</span>
            </div>

            <div class="teaser-card">
                <div class="teaser-icon">📈</div>
                <h3 class="teaser-title">Gestione Pipeline Avanzata</h3>
                <p class="teaser-description">Organizza le opportunità per priorità e stato, con promemoria intelligenti.</p>
                <span class="teaser-soon">Dettagli al lancio</span>
            </div>
            
            <div class="teaser-card">
                <div class="teaser-icon">🛡️</div>
                <h3 class="teaser-title">100% Conforme al GDPR</h3>
                <p class="teaser-description">Raccolta e trattamento dati in conformità al Regolamento Europeo.</p>
                <span class="teaser-soon">Dettagli al lancio</span>
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section class="faq">
        <h2 class="section-title">Domande <span class="premium">Frequenti</span></h2>
        
        <div class="faq-item">
            <div class="faq-question">Quando potrò iniziare a utilizzarlo? <span class="faq-icon">+</span></div>
            <div class="faq-answer">Avrai accesso esclusivo dal 2 febbraio 2026, con priorità assoluta se ti iscrivi subito alla lista d'attesa.</div>
        </div>

        <div class="faq-item">
            <div class="faq-question">Quali vantaggi avrò iscrivendomi ora? <span class="faq-icon">+</span></div>
            <div class="faq-answer">I posti sono limitati: iscrivendoti subito sarai tra i primi ad accedere alle aree di tuo interesse.</div>
        </div>

        <div class="faq-item">
            <div class="faq-question">Quanto costerà? <span class="faq-icon">+</span></div>
            <div class="faq-answer">Riceverai i dettagli solo se sei iscritto alla lista d'attesa. Possiamo anticipare che l'investimento sarà minimo rispetto al costo di un collaboratore part-time che ti supporti in queste attività.</div>
        </div>

        <div class="faq-item">
            <div class="faq-question">Che tipo di contatti riceverò? <span class="faq-icon">+</span></div>
            <div class="faq-answer">Riceverai nominativi di imprenditori già profilati, con dati verificati e in linea con le tue esigenze di sviluppo come consulente finanziario.</div>
        </div>

        <div class="faq-item">
            <div class="faq-question">Con quale frequenza riceverò i contatti? <span class="faq-icon">+</span></div>
            <div class="faq-answer">Avrai un flusso costante e gestibile di nuove opportunità ogni settimana.</div>
        </div>

        <div class="faq-item">
            <div class="faq-question">Cosa significa esclusività territoriale? <span class="faq-icon">+</span></div>
            <div class="faq-answer">La tua area geografica avrà posti limitati: i contatti che riceverai non saranno condivisi con nessun altro consulente.</div>
        </div>

        <div class="faq-item">
            <div class="faq-question">I dati che riceverò sono davvero utilizzabili? <span class="faq-icon">+</span></div>
            <div class="faq-answer">Sì. Tutti i contatti provengono da fonti pubbliche e ufficiali, raccolti e trattati nel pieno rispetto del Regolamento Europeo. Potrai quindi utilizzarli in totale tranquillità per la tua attività di sviluppo commerciale.</div>
        </div>

        <div class="faq-item">
            <div class="faq-question">Ho visto che i posti sono esauriti, conviene iscriversi comunque? <span class="faq-icon">+</span></div>
            <div class="faq-answer">Assolutamente sì! I 100 posti iniziali sono per l'accesso anticipato, ma ogni provincia avrà il suo pacchetto di posti dedicati. Iscrivendoti ora, anche se vedi la lista piena, garantisci la tua priorità per la provincia che hai selezionato. Le assegnazioni vengono fatte per area geografica, quindi potresti comunque ottenere l'accesso nella tua zona di interesse. Inoltre, sarai il primo a essere avvisato se si liberano posti o quando apriremo nuove disponibilità.</div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="social-links">
                <a href="#" class="social-link">Email</a>
                <a href="#" class="social-link">Privacy</a>
                <a href="#" class="social-link">Termini</a>
            </div>
            <p class="footer-text">© 2025 dexxa - Il primo Co-pilota per lo Sviluppo Commerciale. Tutti i diritti riservati.<br>La piattaforma di intelligenza artificiale che rivoluziona la ricerca clienti dei consulenti finanziari, con contatti qualificati, esclusività territoriale e automazione completa.</p>
        </div>
    </footer>
    <script>
const GAS_ENDPOINT = 'https://script.google.com/macros/s/AKfycbzZvfHLpFsbOhiXTBTq0IfGbWv2J0dQnq17qpBwjmBj7_AO-yxlu-RqoGO9VRXLMYl1wQ/exec';
const TOTAL_SPOTS = 100;

let subscriptions = 0;

const spotsLeftEl = document.getElementById('spotsLeft');
const subsCountEl = document.getElementById('subsCount');
const progressFillEl = document.getElementById('progressFill');
const oversubNoteEl = document.getElementById('oversubNote');

function renderProgress() {
  const used = Math.max(0, Math.min(subscriptions, TOTAL_SPOTS));
  const left = Math.max(0, TOTAL_SPOTS - used);
  if (subsCountEl) subsCountEl.textContent = used.toString();
  if (spotsLeftEl) spotsLeftEl.textContent = left.toString();
  const percent = Math.min(100, (used / TOTAL_SPOTS) * 100);
  if (progressFillEl) progressFillEl.style.width = percent + '%';
  if (oversubNoteEl) oversubNoteEl.classList.toggle('show', used >= TOTAL_SPOTS);
}

async function syncCountFromServer() {
  try {
    const res = await fetch(GAS_ENDPOINT + '?t=' + Date.now(), { method:'GET', mode:'cors', cache:'no-store' });
    const json = await res.json();
    if (json && json.ok && Number.isFinite(json.total)) {
      subscriptions = json.total;
      try { localStorage.setItem('dexxa_total', String(json.total)); } catch (_) {}
      renderProgress();
    }
  } catch (err) {
    console.warn('Sync error:', err);
  }
}

document.addEventListener('DOMContentLoaded', () => {
  // Instant paint from local cache (if present), then authoritative sync
  try {
    const cached = Number(localStorage.getItem('dexxa_total'));
    if (Number.isFinite(cached)) {
      subscriptions = cached;
      renderProgress();
    }
  } catch (_) {}
  syncCountFromServer();                 // immediate real value from the sheet
  setInterval(syncCountFromServer, 30000); // refresh every 30s
});

document.getElementById('waitlistForm')?.addEventListener('submit', async (e) => {
  e.preventDefault();
  const form = e.target;
  const submitBtn = document.getElementById('submitBtn');
  const spinner = document.getElementById('spinner');
  const successMsg = document.getElementById('successMessage');

  const email = (form.email.value || '').toLowerCase().trim();
  const domain = email.split('@')[1];
  const freeDomains = ['gmail.com','outlook.com','hotmail.com','yahoo.com','icloud.com','live.com','aol.com'];
  if (domain && freeDomains.includes(domain)) {
    alert('Per iscriversi è necessario utilizzare una email professionale (es. nome@azienda.com).');
    return;
  }

  if (submitBtn) { submitBtn.disabled = True = False; }
  submitBtn.disabled = true;
  submitBtn.textContent = 'Registrazione in corso...';
  spinner?.classList.add('show');

  const payload = {
    timestamp: new Date().toISOString(),
    name: form.name.value || '',
    email,
    company: form.company.value || '',
    role: form.role.value || '',
    province: form.province.value || '',
    leads: form.leads.value || '',
    privacy: form.privacy.checked ? 'yes' : 'no',
    userAgent: navigator.userAgent,
    referrer: document.referrer || ''
  };

  try {
    const res = await fetch(GAS_ENDPOINT, {
      method: 'POST',
      headers: { 'Content-Type': 'text/plain;charset=utf-8' },
      body: JSON.stringify(payload),
      mode: 'cors'
    });
    const json = await res.json();
    if (json && json.ok) {
      subscriptions += 1;         // immediate optimistic update
      renderProgress();
      try { localStorage.setItem('dexxa_total', String(subscriptions)); } catch (_) {}

      successMsg?.classList.add('show');
      form.reset();
      setTimeout(() => successMsg?.classList.remove('show'), 5000);

      setTimeout(syncCountFromServer, 1000); // reconcile with sheet
    } else {
      alert('Errore: ' + (json?.error || 'Riprova più tardi.'));
    }
  } catch (err) {
    alert('Errore di rete: ' + (err?.message || err));
  } finally {
    spinner?.classList.remove('show');
    submitBtn.disabled = false;
    submitBtn.textContent = 'Blocca il tuo Accesso Prioritario';
  }
});
    </script>
</body>
</html>
